# TCP í˜¼ì¡ ì œì–´(Congestion Control) ì‹œë®¬ë ˆì´ì…˜

ì´ í”„ë¡œì íŠ¸ëŠ” Cë¡œ êµ¬í˜„ëœ UDP ê¸°ë°˜ ë°ì´í„° ì „ì†¡ í”„ë¡œê·¸ë¨ìœ¼ë¡œ, TCP Reno í˜¼ì¡ì œì–´ ì•Œê³ ë¦¬ì¦˜ì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
computernetwork/
â”œâ”€â”€ sender.c          # ì†¡ì‹  í”„ë¡œê·¸ë¨ (TCP Reno í˜¼ì¡ì œì–´ êµ¬í˜„)
â”œâ”€â”€ receiver.c        # ìˆ˜ì‹  í”„ë¡œê·¸ë¨ (ëˆ„ì  ACK, íŒ¨í‚· ì†ì‹¤ ì‹œë®¬ë ˆì´ì…˜)
â”œâ”€â”€ Makefile          # ë¹Œë“œ ì„¤ì •
â”œâ”€â”€ run_sender.sh     # ì†¡ì‹  í”„ë¡œê·¸ë¨ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ run_receiver.sh   # ìˆ˜ì‹  í”„ë¡œê·¸ë¨ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
```

## ğŸ”¨ ë¹Œë“œ

```bash
make
```

ìƒì„±ë¬¼: `sender`, `receiver`

## ğŸš€ ì‹¤í–‰

### ë°©ë²• 1: ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (ê¶Œì¥)

**ìˆ˜ì‹ ì¸¡ ì‹¤í–‰** (í„°ë¯¸ë„ 1):
```bash
./run_receiver.sh
```

**ì†¡ì‹ ì¸¡ ì‹¤í–‰** (í„°ë¯¸ë„ 2):
```bash
./run_sender.sh
```

### ë°©ë²• 2: ì§ì ‘ ì‹¤í–‰

**ìˆ˜ì‹ ì¸¡** (í¬íŠ¸ 9000, ì¶œë ¥ íŒŒì¼ output.bin, ì†ì‹¤í™•ë¥  5%):
```bash
./receiver 9000 output.bin 0.05
```

**ì†¡ì‹ ì¸¡** (ìˆ˜ì‹  IP 127.0.0.1, í¬íŠ¸ 9000, ì…ë ¥ íŒŒì¼ input.bin, MSS 1500, RTO 200ms):
```bash
./sender 127.0.0.1 9000 input.bin 1500 200
```

### ìˆ˜ì‹ ì¸¡ ì˜µì…˜

- **íŒŒì¼ ì €ì¥ ì•ˆ í•¨**: `./receiver 9000 - 0.05`
- **ê°•ì œ íŒ¨í‚· ë“œë¡­** (ë°ëª¨ìš©): `./receiver 9000 output.bin 0 7000` (seq 7000 íŒ¨í‚· ë“œë¡­)

## ğŸ“‹ êµ¬í˜„ëœ TCP Reno í˜¼ì¡ì œì–´ ì•Œê³ ë¦¬ì¦˜

### ê¸°ë³¸ ê°€ì •

- **MSS**: 1500 ë°”ì´íŠ¸ (ê¸°ë³¸ê°’, ë³€ê²½ ê°€ëŠ¥)
- **cwnd ì´ˆê¸°ê°’**: 1 MSS (1500 ë°”ì´íŠ¸)
- **ssthresh ì´ˆê¸°ê°’**: 65536 ë°”ì´íŠ¸ (ì„ì˜ ì„¤ì •)
- **ëˆ„ì  ACK**: ìˆ˜ì‹ ì¸¡ì€ ë§¤ë²ˆ ëˆ„ì  ACKë¥¼ ì „ì†¡
- **ë°”ì´íŠ¸ ë‹¨ìœ„ ê³„ì‚°**: cwndì™€ ssthreshëŠ” ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ê³„ì‚°

### Slow Start ìƒíƒœ

**ì¡°ê±´**: `cwnd < ssthresh`

**ìƒˆë¡œìš´ ACK ìˆ˜ì‹  ì‹œ**:
- `dupACKcount = 0`
- `cwnd = cwnd + MSS` (ì§€ìˆ˜ì  ì¦ê°€)

**ì¤‘ë³µ ACK ìˆ˜ì‹  ì‹œ**:
- `dupACKcount++`
- `dupACKcount == 3`ì´ë©´ Fast Recoveryë¡œ ì „ì´

**Timeout ë°œìƒ ì‹œ**:
- `ssthresh = cwnd / 2`
- `cwnd = 1 MSS`
- Slow Startë¡œ ì´ˆê¸°í™”

**ìƒíƒœ ì „ì´**: `cwnd >= ssthresh` â†’ Congestion Avoidanceë¡œ ì „ì´

### Congestion Avoidance ìƒíƒœ

**ì¡°ê±´**: `cwnd >= ssthresh`

**ìƒˆë¡œìš´ ACK ìˆ˜ì‹  ì‹œ**:
- `cwnd = cwnd + MSS Ã— (MSS / cwnd)` (ì„ í˜• ì¦ê°€)

**ì¤‘ë³µ ACK ìˆ˜ì‹  ì‹œ**:
- `dupACKcount++`
- `dupACKcount == 3`ì´ë©´ Fast Recoveryë¡œ ì „ì´

**Timeout ë°œìƒ ì‹œ**:
- `ssthresh = cwnd / 2`
- `cwnd = 1 MSS`
- Slow Startë¡œ ì „ì´

### Fast Recovery ìƒíƒœ

**ì§„ì… ì¡°ê±´**: Duplicate ACKê°€ 3ê°œ ë„ë‹¬

**ìƒˆë¡œìš´ ACK ìˆ˜ì‹  ì‹œ**:
- `cwnd = ssthresh`
- `dupACKcount = 0`
- Congestion Avoidance ìƒíƒœë¡œ ì „ì´

**ì¶”ê°€ ì¤‘ë³µ ACK ìˆ˜ì‹  ì‹œ**:
- `cwnd = cwnd + MSS` (ìƒˆ ì„¸ê·¸ë¨¼íŠ¸ ì „ì†¡ í—ˆìš©)

**Timeout ë°œìƒ ì‹œ**:
- `ssthresh = cwnd / 2`
- `cwnd = 1 MSS`
- Slow Start ìƒíƒœë¡œ ì „ì´

## ğŸ” ì£¼ìš” êµ¬í˜„ íŠ¹ì§•

### 1. ë°”ì´íŠ¸ ë‹¨ìœ„ cwnd ê³„ì‚°
- íŒ¨í‚· ë‹¨ìœ„ê°€ ì•„ë‹Œ **ë°”ì´íŠ¸ ë‹¨ìœ„**ë¡œ cwnd ê³„ì‚°
- `cwnd`ëŠ” ì „ì†¡ ê°€ëŠ¥í•œ ë°”ì´íŠ¸ ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„

### 2. ìŠ¬ë¼ì´ë”© ìœˆë„ìš°
- cwnd í¬ê¸°ë§Œí¼ ACK ì—†ì´ íŒ¨í‚· ì „ì†¡
- ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ê³„ì‚°í•˜ì—¬ ì „ì†¡ ê°€ëŠ¥í•œ íŒ¨í‚· ìˆ˜ ê²°ì •

### 3. ëˆ„ì  ACK (Cumulative ACK)
- ìˆ˜ì‹ ì¸¡ì€ ë‹¤ìŒ ê¸°ëŒ€ ë°”ì´íŠ¸ ìœ„ì¹˜ë¥¼ ACKë¡œ ì „ì†¡
- In-order ë°ì´í„°ë§Œ ì²˜ë¦¬

### 4. íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
- `select()`ë¥¼ ì‚¬ìš©í•˜ì—¬ RTO ì‹œê°„ ë™ì•ˆ ëŒ€ê¸°
- íƒ€ì„ì•„ì›ƒ ë°œìƒ ì‹œ ê°€ì¥ ì˜¤ë˜ëœ ë¯¸í™•ì¸ íŒ¨í‚· ì¬ì „ì†¡

### 5. Fast Recovery
- 3ì¤‘ë³µ ACK ë°œìƒ ì‹œ `cwnd = ssthresh + 3 Ã— MSS`
- ì¤‘ë³µ ACKë§ˆë‹¤ `cwnd += MSS`

## ğŸ“Š ë™ì‘ ì˜ˆì‹œ

### Slow Start
```
ì´ˆê¸°: cwnd = 1500, ssthresh = 65536
ACK ìˆ˜ì‹ : cwnd = 3000 â†’ 6000 â†’ 12000 ... (ì§€ìˆ˜ì  ì¦ê°€)
```

### Congestion Avoidance
```
cwnd >= ssthresh: cwnd = 70000
ACK ìˆ˜ì‹ : cwnd += 1500 Ã— (1500 / 70000) â‰ˆ 32 ë°”ì´íŠ¸ (ì„ í˜• ì¦ê°€)
```

### Fast Recovery
```
3-Dup ACK ë°œìƒ:
  ssthresh = cwnd / 2 = 35000
  cwnd = ssthresh + 3 Ã— MSS = 35000 + 4500 = 39500

ì¤‘ë³µ ACK ìˆ˜ì‹ : cwnd += 1500
ìƒˆë¡œìš´ ACK ìˆ˜ì‹ : cwnd = ssthresh = 35000, Congestion Avoidanceë¡œ ì „ì´
```

### Timeout
```
Timeout ë°œìƒ:
  ssthresh = cwnd / 2 = 35000
  cwnd = 1500 (1 MSS)
  Slow Startë¡œ ë³µê·€
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì˜¤ë¥˜ ì—†ëŠ” ê²½ìš°
```bash
# í„°ë¯¸ë„ 1
./receiver 9000 output.bin 0

# í„°ë¯¸ë„ 2
./sender 127.0.0.1 9000 input.bin 1500 200
```
**ê´€ì°°**: Slow Start â†’ Congestion Avoidance ì „í™˜ ê³¼ì •

### ì‹œë‚˜ë¦¬ì˜¤ 2: 3-Dup ACK ì‚¬ê±´
```bash
# í„°ë¯¸ë„ 1 - seq 7000 íŒ¨í‚· ê°•ì œ ë“œë¡­
./receiver 9000 output.bin 0 7000

# í„°ë¯¸ë„ 2
./sender 127.0.0.1 9000 input.bin 1500 200
```
**ê´€ì°°**: Fast Retransmit â†’ Fast Recovery â†’ Congestion Avoidance ì „í™˜

### ì‹œë‚˜ë¦¬ì˜¤ 3: íƒ€ì„ì•„ì›ƒ ì‚¬ê±´
```bash
# í„°ë¯¸ë„ 1 - 10% íŒ¨í‚· ì†ì‹¤
./receiver 9000 output.bin 0.1

# í„°ë¯¸ë„ 2
./sender 127.0.0.1 9000 input.bin 1500 200
```
**ê´€ì°°**: íƒ€ì„ì•„ì›ƒ ë°œìƒ â†’ Slow Start ë³µê·€

## ğŸ“ ì£¼ì˜ì‚¬í•­

- ì‹¤ì œ TCPê°€ ì•„ë‹ˆë¼ **UDP ìœ„ì—ì„œ TCP í˜¼ì¡ì œì–´ë¥¼ ëª¨ì‚¬**í•œ í•™ìŠµìš© êµ¬í˜„ì…ë‹ˆë‹¤
- ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ out-of-order ë²„í¼ë§ì€ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ (ëˆ„ì  ACKë§Œ ì‚¬ìš©)
- ë¡œì»¬/ë™ì¼ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”

## ğŸ§¹ í´ë¦°ì—…

```bash
make clean
```

ë¹Œë“œ ì‚°ì¶œë¬¼(`sender`, `receiver`) ì‚­ì œ

